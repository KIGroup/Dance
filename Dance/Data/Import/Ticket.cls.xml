<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="Dance.Data.Import.Ticket">
<Super>%Persistent,%XML.Adaptor,Dance.Data.Import.ImportBase</Super>
<TimeCreated>63318,1856.760262</TimeCreated>

<Parameter name="CorrelateName">
<Type>%String</Type>
<Default>item</Default>
</Parameter>

<Property name="IdInternal">
<Type>%String</Type>
<Parameter name="XMLNAME" value="biletId"/>
</Property>

<Property name="TournamentIdExternal">
<Type>%String</Type>
<Parameter name="XMLNAME" value="tournirId"/>
</Property>

<Property name="GroupIdInternal">
<Type>%String</Type>
<Parameter name="XMLNAME" value="GroupId"/>
</Property>

<UDLText name="T">
<Content><![CDATA[
// Male

]]></Content>
</UDLText>

<Property name="MaleLastName">
<Type>%String</Type>
<Parameter name="XMLNAME" value="SurnameM"/>
</Property>

<Property name="MaleFirstName">
<Type>%String</Type>
<Parameter name="XMLNAME" value="NameM"/>
</Property>

<Property name="MaleNumber">
<Type>%String</Type>
<Parameter name="XMLNAME" value="cplMalePartnerID"/>
</Property>

<Property name="MaleDOBOrAge">
<Type>%String</Type>
<Parameter name="XMLNAME" value="AgeM"/>
</Property>

<UDLText name="T">
<Content><![CDATA[
// Female

]]></Content>
</UDLText>

<Property name="FemaleLastName">
<Type>%String</Type>
<Parameter name="XMLNAME" value="SurnameF"/>
</Property>

<Property name="FemaleFirstName">
<Type>%String</Type>
<Parameter name="XMLNAME" value="NameF"/>
</Property>

<Property name="FemaleNumber">
<Type>%String</Type>
<Parameter name="XMLNAME" value="cplFemalePartnerID"/>
</Property>

<Property name="FemaleDOBOrAge">
<Type>%String</Type>
<Parameter name="XMLNAME" value="AgeF"/>
</Property>

<UDLText name="T">
<Content><![CDATA[
// Other Info

]]></Content>
</UDLText>

<Property name="Trainers">
<Type>%Text</Type>
<Parameter name="MAXLEN" value="3000"/>
<Parameter name="XMLNAME" value="Trener"/>
</Property>

<Property name="City">
<Type>%String</Type>
<Parameter name="XMLNAME" value="City"/>
</Property>

<Property name="Club">
<Type>%String</Type>
<Parameter name="XMLNAME" value="Club"/>
</Property>

<Property name="Amount">
<Type>%String</Type>
<Parameter name="XMLNAME" value="sum"/>
</Property>

<Property name="TDay">
<Type>%String</Type>
<Parameter name="XMLNAME" value="day"/>
</Property>

<Property name="TStatus">
<Type>%String</Type>
<Parameter name="XMLNAME" value="status"/>
</Property>

<Property name="PaymentCreated">
<Type>%String</Type>
<Parameter name="XMLNAME" value="datepay"/>
</Property>

<Property name="OrderIdInternal">
<Type>%String</Type>
<Parameter name="XMLNAME" value="ZakazId"/>
</Property>

<Property name="CodeOne">
<Type>%String</Type>
<Parameter name="XMLNAME" value="kod"/>
</Property>

<Property name="CodeTwo">
<Type>%String</Type>
<Parameter name="XMLNAME" value="kodtwo"/>
</Property>

<Property name="Description">
<Type>%Text</Type>
<Parameter name="MAXLEN" value="3000"/>
<Parameter name="XMLNAME" value="description"/>
</Property>

<Index name="IdInternalIdx">
<Properties>IdInternal</Properties>
<Unique>1</Unique>
</Index>

<Method name="Save">
<ClassMethod>1</ClassMethod>
<FormalSpec>newObj:Dance.Data.Import.Ticket</FormalSpec>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	set newObj.Description = $REPLACE($REPLACE(newObj.Description, $c(10), ""), "&quot;", """")
	
	if (..IdInternalIdxExists(newObj.IdInternal) = 0){
		quit newObj.%Save()
	}
	
	set oldObj = ..IdInternalIdxOpen(newObj.IdInternal)
	set oldObj.Amount = newObj.Amount
	set oldObj.City = newObj.City
	set oldObj.Club = newObj.Club
	set oldObj.CodeOne = newObj.CodeOne
	set oldObj.CodeTwo = newObj.CodeTwo
	set oldObj.Created = newObj.Created
	set oldObj.Description = newObj.Description
	set oldObj.FemaleDOBOrAge = newObj.FemaleDOBOrAge
	set oldObj.FemaleFirstName = newObj.FemaleFirstName
	set oldObj.FemaleLastName = newObj.FemaleLastName
	set oldObj.FemaleNumber = newObj.FemaleNumber
	set oldObj.GroupIdInternal = newObj.GroupIdInternal
	set oldObj.MaleDOBOrAge = newObj.MaleDOBOrAge
	set oldObj.MaleFirstName = newObj.MaleFirstName
	set oldObj.MaleLastName = newObj.MaleLastName
	set oldObj.MaleNumber = newObj.MaleNumber
	set oldObj.OrderIdInternal = newObj.OrderIdInternal
	set oldObj.TournamentIdExternal = newObj.TournamentIdExternal
	set oldObj.Trainers = newObj.Trainers
	set oldObj.TStatus = newObj.TStatus	
			
	quit oldObj.%Save()
]]></Implementation>
</Method>

<UDLText name="T">
<Content><![CDATA[
/*
Example:

<item>
	<biletId>754645</biletId>
	<tournirId>68</tournirId>
	<GroupId>1345</GroupId>	
	<cplMalePartnerID>10345</cplMalePartnerID>
	<SurnameM>Елагин</SurnameM>
	<NameM>Андрей</NameM>
	<AgeM>10</AgeM>
	<cplFemalePartnerID>10345</cplFemalePartnerID>
	<SurnameF>Морозова</SurnameF>
	<NameF>Виктория</NameF>
	<AgeF>11</AgeF>
	<Club><![CDATA[Ритм]]]]><![CDATA[></Club>
	<City><![CDATA[Сыктывкар]]]]><![CDATA[>
	</City>
	<Trener><![CDATA[Шульц Елена, Горохов Александр]]]]><![CDATA[>	</Trener>
	<status>pay</status>
	<sum>600.00</sum>
	<datepay>2014-04-07 20:26:07</datepay>
	<day>2014-05-09</day>
	<ZakazId>345345</ZakazId>
	<kod>45345345ee</kod>
	<kodtwo>erwer4353</kodtwo>
	
	<description><![CDATA[09 Мая 2014 10:00  XIX Кубок ЦСКА &quot;Вальс Победы&quot; 9-11 мая 2014. Дети-2 D E St<br> <strong>Партнер</strong>: Елагин Андрей, Книжка: 105500<br> <strong>Партнерша</strong>: Морозова Виктория, Книжка: 105490 <br>]]]]><![CDATA[></description>
</item>

*/
]]></Content>
</UDLText>

<Storage name="Default">
<Type>%Library.CacheStorage</Type>
<DataLocation>^Dance.Data.Import.TicketD</DataLocation>
<DefaultData>TicketDefaultData</DefaultData>
<IdLocation>^Dance.Data.Import.TicketD</IdLocation>
<IndexLocation>^Dance.Data.Import.TicketI</IndexLocation>
<StreamLocation>^Dance.Data.Import.TicketS</StreamLocation>
<ExtentSize>100000</ExtentSize>
<Data name="TicketDefaultData">
<Value name="1">
<Value>%%CLASSNAME</Value>
</Value>
<Value name="2">
<Value>IdExternal</Value>
</Value>
<Value name="3">
<Value>TournamentIdExternal</Value>
</Value>
<Value name="4">
<Value>GroupIdInternal</Value>
</Value>
<Value name="5">
<Value>ManNumber</Value>
</Value>
<Value name="6">
<Value>WomenNumber</Value>
</Value>
<Value name="7">
<Value>Amount</Value>
</Value>
<Value name="8">
<Value>TStatus</Value>
</Value>
<Value name="9">
<Value>Created</Value>
</Value>
<Value name="10">
<Value>OrderIdInternal</Value>
</Value>
<Value name="11">
<Value>CodeOne</Value>
</Value>
<Value name="12">
<Value>CodeTwo</Value>
</Value>
<Value name="13">
<Value>Description</Value>
</Value>
<Value name="14">
<Value>MaleLastName</Value>
</Value>
<Value name="15">
<Value>MaleFirstName</Value>
</Value>
<Value name="16">
<Value>MaleNumber</Value>
</Value>
<Value name="17">
<Value>MaleDOBOrAge</Value>
</Value>
<Value name="18">
<Value>FemaleLastName</Value>
</Value>
<Value name="19">
<Value>FemaleFirstName</Value>
</Value>
<Value name="20">
<Value>FemaleNumber</Value>
</Value>
<Value name="21">
<Value>FemaleDOBOrAge</Value>
</Value>
<Value name="22">
<Value>Trainers</Value>
</Value>
<Value name="23">
<Value>City</Value>
</Value>
<Value name="24">
<Value>Club</Value>
</Value>
<Value name="25">
<Value>DDay</Value>
</Value>
<Value name="26">
<Value>TDay</Value>
</Value>
<Value name="27">
<Value>IdInternal</Value>
</Value>
<Value name="28">
<Value>PaymentCreated</Value>
</Value>
</Data>
</Storage>
</Class>
</Export>
