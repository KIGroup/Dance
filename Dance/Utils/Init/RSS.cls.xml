<?xml version="1.0" encoding="UTF-8"?>
<Export generator="Cache" version="25">
<Class name="Dance.Utils.Init.RSS">
<Super>BaseInit</Super>
<TimeCreated>63275,46658.047854</TimeCreated>

<Method name="Test">
<ClassMethod>1</ClassMethod>
<ReturnType>%Status</ReturnType>
<Implementation><![CDATA[
	do ##class(Dance.Data.RSS).%KillExtent()
	
	set httprequest = ##class(%Net.HttpRequest).%New()
	set httprequest.Server = "www.worlddancesport.org"
	set httprequest.ContentType = "application/rss+xml"
	do httprequest.Get("/Calendar/Competition/Upcoming/rss")
    
 
	#dim stream As %Stream.Object = httprequest.HttpResponse.Data
	#dim reader As %XML.Reader = ##class(%XML.Reader).%New()

	set sc = reader.OpenStream(stream, "literal")
	if $$$ISERR(sc) {
		write !, $System.Status.DisplayError(sc)
		quit sc
	}

	do reader.Correlate("item", "Dance.Data.RSS")

	while reader.Next(.obj, .sc)
	{
		if $$$ISERR(sc)
		{
			write !, $System.Status.DisplayError(sc)
			quit
		}
		
		set sc = obj.%Save()
		
		if $$$ISERR(sc)
		{
			write !, $System.Status.DisplayError(sc)
			quit 
		}
		
		set obj = ""
	}
]]></Implementation>
</Method>

<XData name="RSSXData">
<Data><![CDATA[
<RSSXData>
	<rss xmlns:a10="http://www.w3.org/2005/Atom" version="2.0">
<channel xml:base="http://www.worlddancesport.org/">
<title>IDSF Competition Results</title>
<link>http://www.worlddancesport.org/Calendar/Competition/Results/rss</link>
<description />
<item>
	<guid isPermaLink="false">19640</guid>
	<link>http://www.worlddancesport.org/Event/Competition/World_Cup-Marseille-19640</link>
	<title>WDSF World Cup in Marseille, France on 22 March 2014</title>
	<description>&lt;h1&gt;WDSF World Cup in Marseille, France on 22 March 2014&lt;/h1&gt;&lt;h2&gt;WDSF World Cup&lt;/h2&gt;&lt;p&gt;Contact : M. Jean Vagnol -&amp;nbsp; &lt;a href="mailto:j.vagnol@bbox.fr"&gt;j.vagnol@bbox.fr&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;Organizer's website&lt;/h2&gt;&lt;p&gt;&lt;a href="http://cadmdanse.free.fr"&gt;cadmdanse.free.fr&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;Competitions&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;22 March 2014 &lt;a href="http://www.worlddancesport.org/Event/Competition/World_Cup-Marseille-19640/Adult-Latin-45980/Ranking"&gt;Latin Adult&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</description>
	<a10:updated>2014-03-23T15:32:15+01:00</a10:updated>
</item>
<item>
	<guid isPermaLink="false">19689</guid>
	<link>http://www.worlddancesport.org/Event/Competition/International_Open-Marseille-19689</link>
	<title>WDSF International Open in Marseille, France on 22 March 2014</title>
	<description>&lt;h1&gt;WDSF International Open in Marseille, France on 22 March 2014&lt;/h1&gt;&lt;h2&gt;WDSF International Open&lt;/h2&gt;&lt;p&gt;Contact : M. Jean Vagnol -&amp;nbsp; &lt;a href="mailto:j.vagnol@bbox.fr"&gt;j.vagnol@bbox.fr&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;Organizer's website&lt;/h2&gt;&lt;p&gt;&lt;a href="http://cadmdanse.free.fr"&gt;cadmdanse.free.fr&lt;/a&gt;&lt;/p&gt;&lt;h2&gt;Competitions&lt;/h2&gt;&lt;ul&gt;&lt;li&gt;22 March 2014 &lt;a href="http://www.worlddancesport.org/Event/Competition/International_Open-Marseille-19689/Adult-Standard-46174/Ranking"&gt;Standard Adult&lt;/a&gt;&lt;/li&gt;&lt;li&gt;23 March 2014 &lt;a href="http://www.worlddancesport.org/Event/Competition/International_Open-Marseille-19689/Adult-Latin-46175/Ranking"&gt;Latin Adult&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;</description>
</item>
</channel></rss>
	</RSSXData>
]]></Data>
</XData>
</Class>
</Export>
